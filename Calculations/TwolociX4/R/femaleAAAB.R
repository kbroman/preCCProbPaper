# transpose of "transition" matrix for calculating Pr(AA|AB) for female in 4-way RIL, X chr
femaleAAABtm <- function(r) cbind(
c(0,(1-r),r,(1-r),r,0,0,0,0,0,0,0,0,0,0,0,0,0),
c((r^2+(1-r)^2)/8,0,0,(1-r)/2,r/2,r*(1-r)/4,r*(1-r)/4,0,0,0,0,0,0,0,0,0,0,0),
c(0,0,0,0,0,0,0,1/4,(1-r)/4,r/4,0,0,0,r/4,(1-r)/4,0,0,0),
c((r^2+(1-r)^2)/8,(1-r)/2,r/2,0,0,r*(1-r)/4,r*(1-r)/4,0,0,0,0,0,0,0,0,0,0,0),
c(0,0,0,0,0,0,0,0,0,0,1/4,(1-r)/4,r/4,(1-r)/4,r/4,0,0,0),
c(0,0,0,0,0,0,0,0,0,0,0,(1-r)/2,r/2,0,0,1/2,0,0),
c(0,0,0,0,0,0,0,0,(1-r)/2,r/2,0,0,0,0,0,0,1/2,0),
c(0,1/4,1/4,0,0,0,0,0,0,0,0,0,0,r/4,(1-r)/4,0,0,0),
c(0,0,0,0,0,r/4,(1-r)/4,0,0,0,0,0,0,0,0,0,1/2,0),
c(0,0,0,0,0,0,0,0,0,0,0,1/4,1/4,0,0,0,0,1/8),
c(0,0,0,1/4,1/4,0,0,0,0,0,0,0,0,(1-r)/4,r/4,0,0,0),
c(0,0,0,0,0,(1-r)/4,r/4,0,0,0,0,0,0,0,0,1/2,0,0),
c(0,0,0,0,0,0,0,0,1/4,1/4,0,0,0,0,0,0,0,1/8),
c(0,0,0,1/4,1/4,0,0,0,0,0,1/4,(1-r)/4,r/4,0,0,0,0,0),
c(0,1/4,1/4,0,0,0,0,1/4,(1-r)/4,r/4,0,0,0,0,0,0,0,0),
c(0,0,0,0,0,(1-r)/4,r/4,0,0,0,0,(1-r)/2,r/2,0,0,0,0,0),
c(0,0,0,0,0,r/4,(1-r)/4,0,(1-r)/2,r/2,0,0,0,0,0,0,0,0),
c(0,0,0,0,0,0,0,0,1/2,1/2,0,1/2,1/2,0,0,0,0,0)
)

# start matrix for calculating Pr(AA|AB) for female in 4-way RIL, X chr
femaleAAABstart <- rbind(
"AA|AB"=c(0,0,0,0,0,1/2,0,0,0,0,0,0,0,0,0,0,0,0),
"AA|AC"=c(0,0,0,0,0,0,0,0,0,0,0,1/2,0,0,0,0,0,0),
"AB|AC"=c(0,0,0,0,0,0,0,0,0,0,0,0,1/2,0,0,0,0,0),
"AB|CC"=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1),
"AC|CC"=c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1/2,0,0)
)

b <- as.matrix(c(1, rep(0,17)))
