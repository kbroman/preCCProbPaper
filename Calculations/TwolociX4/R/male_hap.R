# male X chr haplotype probabilities for 4-way RIL by sib mating
malehaporig <- function(r,k) c(
"AA"= 1/(12*r+3) - 1/(3*r+3)*(-1/2)^k + 
       (r^3 - sqrt(r^2-10*r+5)*(8*r^3+r^2-3*r)-10*r^2+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5)/2 *
       ((1 - r + sqrt(r^2-10*r+5))/4)^k + 
       +(r^3 + sqrt(r^2-10*r+5)*(8*r^3+r^2-3*r)-10*r^2+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5)/2 *
       ((1 - r - sqrt(r^2-10*r+5))/4)^k
,
"AB"= 2*r/(12*r+3) - 2*r/(3*r+3)*(-1/2)^k + 
       (r^4 + sqrt(r^2-10*r+5)*(5*r^3-r)-10*r^3+5*r^2)/(4*r^4-35*r^3-29*r^2+15*r+5) *
       ((1 - r + sqrt(r^2-10*r+5))/4)^k + 
       +(r^4 - sqrt(r^2-10*r+5)*(5*r^3-r)-10*r^3+5*r^2)/(4*r^4-35*r^3-29*r^2+15*r+5) *
       ((1 - r - sqrt(r^2-10*r+5))/4)^k
,
"AC"= 2*r/(12*r+3) + r/(3*r+3)*(-1/2)^k + 
       -0.5*(2*r^4 + sqrt(r^2-10*r+5)*(2*r^3-r^2+r)-19*r^3+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5) *
       ((1 - r + sqrt(r^2-10*r+5))/4)^k + 
       -0.5*(2*r^4 - sqrt(r^2-10*r+5)*(2*r^3-r^2+r)-19*r^3+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5) *
       ((1 - r - sqrt(r^2-10*r+5))/4)^k
,
"CC"= 1/(12*r+3) + 2/(3*r+3)*(-1/2)^k + 
       (2*r^4 + sqrt(r^2-10*r+5)*(2*r^3-r^2+r)-19*r^3+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5) *
       ((1 - r + sqrt(r^2-10*r+5))/4)^k + 
       (2*r^4 - sqrt(r^2-10*r+5)*(2*r^3-r^2+r)-19*r^3+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5) *
       ((1 - r - sqrt(r^2-10*r+5))/4)^k
)# male X chr haplotype probabilities for 4-way RIL by sib mating
malehap <- function(r,k) c(
"AA"= ((1)/(3*(1+4*r))) - ((1)/(3*(1+r)))*(-((1)/(2)))^k + (((r^3 - (8*r^3+r^2-3*r)*sqrt(r^2-10*r+5)-10*r^2+5*r)/(2*(4*r^4-35*r^3-29*r^2+15*r+5)))) *(((1 - r + sqrt(r^2-10*r+5))/(4)))^k + (((r^3 + (8*r^3+r^2-3*r)*sqrt(r^2-10*r+5)-10*r^2+5*r)/(2*(4*r^4-35*r^3-29*r^2+15*r+5)))) *(((1 - r - sqrt(r^2-10*r+5))/(4)))^k,
"AB"= ((2*r)/(3*(1+4*r))) - ((2*r)/(3*(1+r)))*(-((1)/(2)))^k + (((r^4 + (5*r^3-r)*sqrt(r^2-10*r+5)-10*r^3+5*r^2)/(4*r^4-35*r^3-29*r^2+15*r+5))) *(((1 - r + sqrt(r^2-10*r+5))/(4)))^k +(((r^4 - (5*r^3-r)*sqrt(r^2-10*r+5)-10*r^3+5*r^2)/(4*r^4-35*r^3-29*r^2+15*r+5))) *(((1 - r - sqrt(r^2-10*r+5))/(4)))^k,
"AC"= ((2*r)/(3*(1+4*r))) + ((r)/(3*(1+r)))*(-((1)/(2)))^k - (((2*r^4 + (2*r^3-r^2+r)*sqrt(r^2-10*r+5)-19*r^3+5*r)/(2*(4*r^4-35*r^3-29*r^2+15*r+5)))) *(((1 - r + sqrt(r^2-10*r+5))/(4)))^k - (((2*r^4 - (2*r^3-r^2+r)*sqrt(r^2-10*r+5)-19*r^3+5*r)/(2*(4*r^4-35*r^3-29*r^2+15*r+5)))) *(((1 - r - sqrt(r^2-10*r+5))/(4)))^k,
"CC"= ((1)/(3*(1+4*r))) + ((2)/(3*(1+r)))*(-((1)/(2)))^k + (((2*r^4 + (2*r^3-r^2+r)*sqrt(r^2-10*r+5)-19*r^3+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5))) *(((1 - r + sqrt(r^2-10*r+5))/(4)))^k + (((2*r^4 - (2*r^3-r^2+r)*sqrt(r^2-10*r+5)-19*r^3+5*r)/(4*r^4-35*r^3-29*r^2+15*r+5))) *(((1 - r - sqrt(r^2-10*r+5))/(4)))^k)

# matrix for calculating male X chr haplotype probabilities for 4-way RIL by sib mating 
malehaptm <- function(r) rbind(
"AA" = c("AA" = 0, "AB" = 1/2, "AC" = 0, "CC" = 0)
,
"AB" = c("AA" = 1-r, "AB" = (1-r)/2, "AC" = 0, "CC" = 1/4)
,
"AC" = c("AA" = r, "AB" = r/2, "AC" = 0, "CC" = 1/4)
,
"CC" = c("AA" = 0, "AB" = 0, "AC" = 1, "CC" = 1/2)
)


# starting values for calculating male X chr haplotype probabilities for 4-way RIL by sib mating 
malehapstart <- rbind(
"AA" = c("AA" = 0, "AB" = 1/2, "AC" = 0, "CC" = 0)
,
"AB" = c("AA" = 0, "AB" = 0, "AC" = 1/2, "CC" = 0)
,
"AC" = c("AA" = 0, "AB" = 0, "AC" = 0, "CC" = 1/4)
,
"CC" = c("AA" = 1, "AB" = 0, "AC" = 0, "CC" = 0)
)


b <- rbind(1, 0, 0, 0)
