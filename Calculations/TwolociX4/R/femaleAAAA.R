# transpose of "transition" matrix for calculating Pr(AA|AA) for female in 4-way RIL, X chr
femaleAAAAtm <- function(r) cbind(
c(0,(1-r),r,0,0,0,0,0,0,0,0,0,0),
c((r^2+(1-r)^2)/4,(1-r)/2,r/2,(1-r)^2/4,r*(1-r),0,0,0,r^2/4,0,0,0,0),
c(0,0,0,0,0,(1-r)/2,r/2,0,0,0,1/2,0,0),
c(0,0,0,(1-r)/2,0,0,0,0,r/2,1/2,0,0,0),
c(0,0,0,0,0,(1-r)/2,r/2,0,0,0,0,1/2,0),
c(0,0,0,(1-r)/4,1/4,0,0,0,r/4,0,0,1/2,0),
c(0,0,0,0,0,1/4,1/4,1/4,0,0,0,0,1/4),
c(0,0,0,1/4,0,0,0,1/2,1/4,0,0,0,0),
c(0,0,0,0,0,0,0,1,0,0,0,0,0),
c(0,0,0,(1-r),0,0,0,0,r,0,0,0,0),
c(0,1/4,1/4,0,0,(1-r)/4,r/4,0,0,0,1/4,0,0),
c(0,0,0,(1-r)/4,1/4,(1-r)/2,r/2,0,r/4,0,0,0,0),
c(0,0,0,0,0,1/2,1/2,0,0,0,0,0,0)
)

femaleAAAAstart <- matrix(0, nrow=4, ncol=13)
femaleAAAAstart[1,4] <- 1/2
femaleAAAAstart[2,9] <- 1/2
femaleAAAAstart[3,8] <- 1/4
femaleAAAAstart[4,10] <- 1
b <- as.matrix(c(1, rep(0,12)))
