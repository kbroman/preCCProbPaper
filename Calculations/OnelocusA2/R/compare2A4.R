pikA2 <- function(k)
    c(
      "AAxAA"=(1/2) + (1/5)*(1/4)^k - ((7-3*sqrt(5))/20)*((1-sqrt(5))/4)^k - ((7+3*sqrt(5))/20)*((1+sqrt(5))/4)^k,
      "AAxAB"=(-4/5)*(1/4)^k + (2/5)*((1-sqrt(5))/4)^k + (2/5)*((1+sqrt(5))/4)^k,
      "AAxBB"=(2/5)*(1/4)^k + ((3+sqrt(5))/10)*((1-sqrt(5))/4)^k + ((3-sqrt(5))/10)*((1+sqrt(5))/4)^k,
      "ABxAB"=(4/5)*(1/4)^k - ((2 + 2*sqrt(5))/5)*((1-sqrt(5))/4)^k - ((2-2*sqrt(5))/5)*((1+sqrt(5))/4)^k)


pikA4 <- function(k)
    c(
      "AAxAA"=1/4 + (1/4)*(1/2)^k - (1/20)*(1/4)^k - ((9-4*sqrt(5))/40)*((1-sqrt(5))/4)^k - ((9+4*sqrt(5))/40)*((1+sqrt(5))/4)^k,
      "AAxAB"=(1/6)*(-1/4)^k+(1/10)*(1/4)^k-(1/6)*(1/2)^k-((1+sqrt(5))/20)*((1-sqrt(5))/4)^k - ((1-sqrt(5))/20)*((1+sqrt(5))/4)^k,
      "AAxAC"=(-1/12)*(-1/4)^k+(1/20)*(1/4)^k-(1/6)*(1/2)^k + (1/10)*((1-sqrt(5))/4)^k + (1/10)*((1+sqrt(5))/4)^k,
      "AAxBB"=(1/3)*(-1/4)^k-(2/15)*(-1/8)^k+(1/30)*(1/4)^k-(1/30)*(1/2)^k-((2+sqrt(5))/20)*((1-sqrt(5))/4)^k-((2-sqrt(5))/20)*((1+sqrt(5))/4)^k,
      "AAxBC"=(-1/12)*(-1/4)^k + (2/15)*(-1/8)^k - (1/12)*(1/4)^k + (1/30)*(1/2)^k,
      "AAxCC"=(-1/6)*(-1/4)^k + (1/30)*(-1/8)^k + (1/60)*(1/4)^k - (1/30)*(1/2)^k +((3+sqrt(5))/40)*((1-sqrt(5))/4)^k+((3-sqrt(5))/40)*((1+sqrt(5))/4)^k,
      "AAxCD"=(1/6)*(-1/4)^k - (1/5)*(-1/8)^k + (1/30)*(1/2)^k,
      "ABxAB"=(-2/3)*(-1/4)^k+(2/15)*(-1/8)^k+(1/15)*(1/4)^k-(2/15)*(1/2)^k +((3+sqrt(5))/10)*((1-sqrt(5))/4)^k+((3-sqrt(5))/10)*((1+sqrt(5))/4)^k,
      "ABxAC"=(1/6)*(-1/4)^k-(2/15)*(-1/8)^k-(1/6)*(1/4)^k+(2/15)*(1/2)^k,
      "ABxCD"=(2/3)*(-1/8)^k+(1/3)*(1/4)^k,
      "ACxAC"=(1/3)*(-1/4)^k-(1/30)*(-1/8)^k+(1/30)*(1/4)^k-(2/15)*(1/2)^k -((2+2*sqrt(5))/20)*((1-sqrt(5))/4)^k-((2-2*sqrt(5))/20)*((1+sqrt(5))/4)^k,
      "ACxAD"=(-1/3)*(-1/4)^k + (1/5)*(-1/8)^k+(2/15)*(1/2)^k,
      "ACxBD"=(-1/3)*(-1/8)^k + (1/3)*(1/4)^k)

nstatesA2 <- c("AAxAA"=2, "AAxAB"=2, "AAxBB"=1, "ABxAB"=1)
nstatesA4 <- c("AAxAA"=4, "AAxAB"=4, "AAxAC"=8, "AAxBB"=2,
               "AAxBC"=8, "AAxCC"=4, "AAxCD"=4, "ABxAB"=2,
               "ABxAC"=8, "ABxCD"=1, "ACxAC"=4, "ACxAD"=4, "ACxBD"=2)


collapse <- cbind("AAxAA"=c(1, 1, 0, 1, 0,    0, 0, 1, 0, 0,   0, 0, 0),
                  "AAxAB"=c(0, 0, 1, 0, 1,    0, 0, 0, 1, 0,   0, 0, 0), 
                  "AAxBB"=c(0, 0, 0, 0, 0,    1, 1, 0, 0, 1,   0, 0, 0),
                  "ABxAB"=c(0, 0, 0, 0, 0,    0, 0, 0, 0, 0,   1, 1, 1))
  
pikA2p <-
function(k)
  pikA4(k) %*% (collapse * nstatesA4) / nstatesA2

k <- 0:50
maxdif <- rep(NA, length(k))
for(i in seq(along=k))
  maxdif[i] <- max(abs(pikA2(k[i]) - pikA2p(k[i])))
max(maxdif)
