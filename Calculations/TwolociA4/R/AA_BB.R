# transpose of "transition" matrix for calculating Pr(AA:BB) for autosome in 4-way RIL
indAABBtm <- function(r) cbind(
c(0,(1-r)^2/2,r*(1-r)/2,r*(1-r)/2,r^2/2,0,0,0,0,0,0,0,0,0),
c((1-r)^2/2,(1-r)^2/2,r*(1-r)/2,r*(1-r)/2,r^2/2,r^2/2,0,0,0,0,0,0,0,0),
c(0,0,0,0,0,0,(1-r)/4,r/4,0,0,0,0,0,0),
c(0,0,0,0,0,0,0,0,(1-r)/4,r/4,0,0,0,0),
c(0,0,0,0,0,0,0,0,0,0,1/8,1/8,1/8,1/8),
c(0,0,0,0,0,0,0,0,0,0,0,(1-r)^2/2,r*(1-r)/2,r^2/2),
c(0,(1-r)/2,(1-r)/2,r/2,r/2,0,(1-r)/4,r/4,0,0,0,0,0,0),
c(0,0,0,0,0,0,0,0,r/4,(1-r)/4,0,(1-r)/2,1/4,r/2),
c(0,(1-r)/2,r/2,(1-r)/2,r/2,0,0,0,(1-r)/4,r/4,0,0,0,0),
c(0,0,0,0,0,0,r/4,(1-r)/4,0,0,0,(1-r)/2,1/4,r/2),
c(0,1/8,1/8,1/8,1/8,0,0,0,0,0,0,1/8,1/8,1/8),
c(r^2/2,0,0,0,0,(1-r)^2/2,0,0,0,0,0,(1-r)^2/2,r*(1-r)/2,r^2/2),
c(0,0,0,0,0,0,r/4,(1-r)/4,r/4,(1-r)/4,0,0,0,0),
c(0,1/8,1/8,1/8,1/8,0,0,0,0,0,1/8,0,0,0)
)

# start matrix for calculating Pr(AA:BB) for autosome in 4-way RIL
indAABBstart <- rbind(
"AA|BB"=c(1/2,0,0,0,0,0,0,0,0,0,0,0,0,0),
"AA|BC"=c(0,0,0,0,0,0,1/2,0,0,0,0,0,0,0),
"AA|CC"=c(0,1/2,0,0,0,0,0,0,0,0,0,0,0,0),
"AA|CD"=c(0,0,1/2,0,0,0,0,0,0,0,0,0,0,0),
"AB|BA"=c(0,0,0,0,0,1/2,0,0,0,0,0,0,0,0),
"AB|BC"=c(0,0,0,0,0,0,0,1/2,0,0,0,0,0,0),
"AB|CD"=c(0,0,0,0,1/2,0,0,0,0,0,0,0,0,0),
"AC|BD"=c(0,0,0,0,0,0,0,0,0,0,1/2,0,0,0),
"AC|CA"=c(0,0,0,0,0,0,0,0,0,0,0,1/2,0,0),
"AC|CB"=c(0,0,0,0,0,0,0,0,0,0,0,0,1/2,0),
"AC|DB"=c(0,0,0,0,0,0,0,0,0,0,0,0,0,1/2)
)

mult <- c(2,16,4,8,2,16,4,4,4,8,4)

pi0 <- indAABBstart * mult
b <- as.matrix(c(1, rep(0,13)))
